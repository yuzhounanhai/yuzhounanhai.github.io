<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>浅析VUE双向绑定原理 | 南海の笔记</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="VUE 是一种基于数据截获来实现双向绑定的，这篇文章将浅显的分析一下 VUE 是如何实现双向绑定的，并根据原理，简要实现这部分代码。 MVVMMVVM 目前是一种前端开发的架构模式，其三个组成部分是模型（Model）、视图（View）、视图模型（View Model）。MVVM 使视图和逻辑得以分开，交由视图模型统一管理，由数据驱动视图模型更新，从而影响视图更新；而交互所造成的变动，也将反应在视图">
<meta name="keywords" content="Vue">
<meta property="og:type" content="article">
<meta property="og:title" content="浅析VUE双向绑定原理">
<meta property="og:url" content="https://yuzhounanhai.github.io/2019/09/29/浅析VUE双向绑定原理/index.html">
<meta property="og:site_name" content="南海の笔记">
<meta property="og:description" content="VUE 是一种基于数据截获来实现双向绑定的，这篇文章将浅显的分析一下 VUE 是如何实现双向绑定的，并根据原理，简要实现这部分代码。 MVVMMVVM 目前是一种前端开发的架构模式，其三个组成部分是模型（Model）、视图（View）、视图模型（View Model）。MVVM 使视图和逻辑得以分开，交由视图模型统一管理，由数据驱动视图模型更新，从而影响视图更新；而交互所造成的变动，也将反应在视图">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://yuzhounanhai.github.io/images/20190704/mvvm.png">
<meta property="og:image" content="https://yuzhounanhai.github.io/images/20190704/new_vue.png">
<meta property="og:image" content="https://yuzhounanhai.github.io/images/20190704/new_vue.png">
<meta property="og:image" content="https://yuzhounanhai.github.io/images/20190704/new_vue.png">
<meta property="og:updated_time" content="2019-09-29T07:59:45.739Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="浅析VUE双向绑定原理">
<meta name="twitter:description" content="VUE 是一种基于数据截获来实现双向绑定的，这篇文章将浅显的分析一下 VUE 是如何实现双向绑定的，并根据原理，简要实现这部分代码。 MVVMMVVM 目前是一种前端开发的架构模式，其三个组成部分是模型（Model）、视图（View）、视图模型（View Model）。MVVM 使视图和逻辑得以分开，交由视图模型统一管理，由数据驱动视图模型更新，从而影响视图更新；而交互所造成的变动，也将反应在视图">
<meta name="twitter:image" content="https://yuzhounanhai.github.io/images/20190704/mvvm.png">
  
    <link rel="alternate" href="/atom.xml" title="南海の笔记" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">南海の笔记</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">在海的南边，有一片宇宙！宇宙无垠，而探索无尽，是该同懒癌佛系奋斗！</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://yuzhounanhai.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-浅析VUE双向绑定原理" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/09/29/浅析VUE双向绑定原理/" class="article-date">
  <time datetime="2019-09-29T07:59:45.739Z" itemprop="datePublished">2019-09-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/前端/">前端</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      浅析VUE双向绑定原理
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
          <p>VUE 是一种基于数据截获来实现双向绑定的，这篇文章将浅显的分析一下 VUE 是如何实现双向绑定的，并根据原理，简要实现这部分代码。</p>
<h2 id="MVVM"><a href="#MVVM" class="headerlink" title="MVVM"></a>MVVM</h2><p>MVVM 目前是一种前端开发的架构模式，其三个组成部分是模型（Model）、视图（View）、视图模型（View Model）。<br>MVVM 使视图和逻辑得以分开，交由视图模型统一管理，由数据驱动视图模型更新，从而影响视图更新；<br>而交互所造成的变动，也将反应在视图模型上。</p>
<a id="more"></a>

<p><img src="/images/20190704/mvvm.png" alt="mvvm模型"></p>
<h2 id="MVC-和-MVVM"><a href="#MVC-和-MVVM" class="headerlink" title="MVC 和 MVVM"></a>MVC 和 MVVM</h2><p>MVC 是应用广泛的软件架构的其中一种，MVC 三个字母分别代表了模型（Model）、视图（View）、控制器（Controller）。<br>MVC 一般是一种单向通信的方式（V -&gt; C -&gt; M -&gt; C），但实际项目中可能会对MVC的通信方式进行变更，例如增加 C -&gt; V 的通信道路等。</p>
<p>常规的 MVC 和 MVVM 项目，它们的通信方式是不一样的，而 MVVM 架构最主要的区别就是双向绑定。</p>
<h2 id="一句话概括-VUE-双向绑定实现原理"><a href="#一句话概括-VUE-双向绑定实现原理" class="headerlink" title="一句话概括 VUE 双向绑定实现原理"></a>一句话概括 VUE 双向绑定实现原理</h2><p>VUE 通过 ES5 提供的 <code>Object.defineProperty()</code> 方法，截获数据的 <code>get</code> 和 <code>set</code> 方法，结合观察者-订阅者模式，检查并记录依赖，当数据发生更新时，通知所有有关联的订阅依赖进行更新。</p>
<h4 id="Object-defineProperty"><a href="#Object-defineProperty" class="headerlink" title="Object.defineProperty()"></a>Object.defineProperty()</h4><p>ES5在定义只有内部采用的特性时，描述了属性的各种特征，提供了两种属性的读写方式：</p>
<ol>
<li>数据属性</li>
</ol>
<ul>
<li>Configurable: 表示能否通过delete删除属性从而重新定义属性，能否修改属性的特性，或者能否把属性修改为访问器属性。</li>
<li>Enumerable: 表示能否通过for-in循环返回属性。</li>
<li>Writable: 表示能否修改属性的值。</li>
<li>Value: 表示这个属性的数据值。</li>
</ul>
<ol start="2">
<li>访问器属性</li>
</ol>
<ul>
<li>Configurable</li>
<li>Enumerable</li>
<li>Get: 读取属性时调用的函数，默认为undefined</li>
<li>Set: 在写入属性时调用的函数，默认为undefined</li>
</ul>
<p>要修改属性默认的特性，必须使用ES5提供的Object.defineProperty()方法。<br>这个方法接收三个参数：属性所在的对象、属性名、描述符对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.defineProperty(obj, property, &#123;</span><br><span class="line">    configurable: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h2><p>在我们使用 <code>new Vue({})</code> 方法，传入一个 Vue 对象的对象字面量时，VUE 应该去做以下事情：</p>
<ul>
<li>解析数据</li>
<li>解析模板</li>
<li>绑定模板和数据</li>
</ul>
<p>这三个步骤是十分浅显可以了解的，解析了数据和模版后，程序才能理解什么位置该填充什么数据，而绑定模版和数据，也是为了在数据发生变更时，模版视图能够及时刷新。<br>实际上，我们在使用 <code>new</code> 操作符实例化 VUE 对象后，整个构造函数大致的跑了以下这个流程：</p>
<p><img src="/images/20190704/new_vue.png" alt="vue原理流程图"></p>
<p>整个流程图较为”庞大”，后面的章节将会紧密贴合这个图进行讲解。我先来简单的介绍一下这个流程图的流程：</p>
<ul>
<li><p>在使用 <code>new</code> 操作符后，分别进行解析数据和解析模版的工作</p>
</li>
<li><p>构建观察者-订阅者结构，绑定模板和数据</p>
</li>
</ul>
<p>简单分析得到的其实也就是我们之前所分析到的三个工作。</p>
<h4 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h4><p>在开始了解原理之前我们先来回忆一下我们该如何使用构造函数。它应该是这样被使用的：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mvvm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">"#container"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        name: <span class="string">"nanhai"</span>,</span><br><span class="line">        num: <span class="number">1</span>,</span><br><span class="line">        color: <span class="string">"red"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        changeNum: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.num++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>从本文之前的“一句话概括 VUE 原理”中，我们不难联系出这样一个结果：</p>
<ul>
<li><p>new Vue(options)后，需要获得传入options内的el，拿到对应的dom，解析模板。</p>
</li>
<li><p>解析options中的其他数据，如 data ，通过 <code>Object.defineProperty()</code>，设立 <code>get</code> / <code>set</code> 方法，截获数据。</p>
</li>
</ul>
<h4 id="new-MVVM"><a href="#new-MVVM" class="headerlink" title="new MVVM()"></a>new MVVM()</h4><p>接下来将实现一个 MVVM 方法，来做与 VUE 类似的工作。从前文可得，这个构造函数内首当其冲的工作是解析数据（observe）和解析模板（Compile）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MVVM</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>._options = options || &#123;&#125;;</span><br><span class="line">    <span class="keyword">var</span> data = <span class="keyword">this</span>._data = <span class="keyword">this</span>._options.data || &#123;&#125;;</span><br><span class="line">    <span class="comment">// 解析数据</span></span><br><span class="line">    observe(data);</span><br><span class="line">    <span class="comment">// 解析模板</span></span><br><span class="line">    <span class="keyword">new</span> Compile(<span class="keyword">this</span>._options.el || <span class="built_in">document</span>.body, <span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> mvvm = <span class="keyword">new</span> MVVM(&#123;</span><br><span class="line">    el: <span class="string">"#container"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        name: <span class="string">"nanhai"</span>,</span><br><span class="line">        num: <span class="number">1</span>,</span><br><span class="line">        color: <span class="string">"red"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        changeNum: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.num++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="数据代理"><a href="#数据代理" class="headerlink" title="数据代理"></a>数据代理</h4><p>在上面实现的构造函数中，先来思考一下怎么拿到 data 中定义的数据？（比如拿 name ）<br>我们需要通过 <code>mvvm._data.name</code> 这样的方式来拿到 name 数据，但是这样的方式与我们在使用 VUE 时并不一致，所以我们需要进行一个数据代理。<br>所谓的数据代理，其实也就是将 <code>mvvm._data</code> 上的数据，全部映射到 <code>mvvm</code> 上。通过 <code>Object.defineProperty()</code> 方法可以轻松的实现这一映射。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MVVM.prototype = &#123;</span><br><span class="line">    _proxyData: <span class="function"><span class="keyword">function</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> self = <span class="keyword">this</span>;</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(self, key, &#123;</span><br><span class="line">            configurable: <span class="literal">false</span>,</span><br><span class="line">            enumerable: <span class="literal">true</span>,</span><br><span class="line">            <span class="keyword">get</span>: function proxyGetter() &#123;</span><br><span class="line">                <span class="keyword">return</span> self._data[key];</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="keyword">set</span>: function proxySetter(newValue) &#123;</span><br><span class="line">                self._data[key] = newValue;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在实现完映射方法后，我们只需要遍历 data 中的 key ，然后调用 <code>_proxyData</code> 方法即可。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MVVM</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>._options = options || &#123;&#125;;</span><br><span class="line">    <span class="keyword">var</span> data = <span class="keyword">this</span>._data = <span class="keyword">this</span>._options.data || &#123;&#125;;</span><br><span class="line">    <span class="comment">// 增加这段代码</span></span><br><span class="line">    <span class="keyword">var</span> self = <span class="keyword">this</span>;</span><br><span class="line">    <span class="built_in">Object</span>.keys(data).forEach(<span class="function"><span class="keyword">function</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">        self._proxyData(key);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 结束</span></span><br><span class="line">    observe(data);</span><br><span class="line">    <span class="keyword">new</span> Compile(<span class="keyword">this</span>._options.el || <span class="built_in">document</span>.body, <span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="observe-数据解析"><a href="#observe-数据解析" class="headerlink" title="observe 数据解析"></a>observe 数据解析</h4><p>数据解析，实质就是为数据绑定 <code>get</code> 和 <code>set</code> 方法，使在读、写数据时能够截获到这个操作。因此这一段代码也就是调用 <code>Object.defineProperty()</code> 这个 api 进行实现。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">observe</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!data || <span class="keyword">typeof</span> data !== <span class="string">'object'</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Object</span>.keys(data).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">        observeProperty(data, key, data[key])</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">observeProperty</span>(<span class="params">data, key, val</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 监听子属性</span></span><br><span class="line">    observe(val);</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(data, key, &#123;</span><br><span class="line">        <span class="comment">// 可枚举</span></span><br><span class="line">        enumerable: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// 不能再define</span></span><br><span class="line">        configurable: <span class="literal">false</span>,</span><br><span class="line">        <span class="keyword">get</span>: function () &#123;</span><br><span class="line">            <span class="keyword">return</span> val;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="keyword">set</span>: function (newVal) &#123;</span><br><span class="line">            <span class="keyword">if</span> (</span><br><span class="line">                newVal === val || </span><br><span class="line">                (</span><br><span class="line">                    newVal !== newVal</span><br><span class="line">                    &amp;&amp; val !== val</span><br><span class="line">                )</span><br><span class="line">            ) &#123;</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            val = newVal;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>判断两个值一样的判断方法是： <code>newVal === val || ( newVal !== newVal &amp;&amp; val !== val )</code><br>为什么要多此一举呢？因为 NaN 永远不等于 NaN</p>
</blockquote>
<h4 id="compile-模板解析"><a href="#compile-模板解析" class="headerlink" title="compile 模板解析"></a>compile 模板解析</h4><p>Compile的工作是解析模板，将模板中的变量、指令替换成数据，对视图进行初始化操作</p>
<p>步骤：</p>
<ol>
<li>拿到模板部分的dom节点</li>
<li>遍历各节点，解析属性指令和 { { } }变量  </li>
<li>将解析好的内容，重新插入回原来的位置中。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Compile</span>(<span class="params">$el, vm</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.$el = <span class="keyword">this</span>.isElementNode($el) ? $el : <span class="built_in">document</span>.querySelector($el);</span><br><span class="line">    <span class="keyword">this</span>._vm = vm;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.$el) &#123;</span><br><span class="line">        <span class="comment">// 由于会频繁的进行dom操作，为了优化性能，将节点先移入documentFragement。</span></span><br><span class="line">        <span class="keyword">this</span>.$fragment = <span class="keyword">this</span>.nodeToFragment(<span class="keyword">this</span>.$el);</span><br><span class="line">        <span class="keyword">this</span>.compileElement(<span class="keyword">this</span>.$fragment);</span><br><span class="line">        <span class="keyword">this</span>.$el.appendChild(<span class="keyword">this</span>.$fragment);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="compileElement"><a href="#compileElement" class="headerlink" title="compileElement()"></a>compileElement()</h4><p>compileElement是Compile的核心，做遍历解析的工作。</p>
<ol>
<li>遍历结点</li>
<li>验证节点类型</li>
<li>匹配模版</li>
<li>替换变量并根据指令做处理</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;div class="div"&gt;div内部的文字&lt;/div&gt;</span></span><br><span class="line">compileElement: <span class="function"><span class="keyword">function</span> (<span class="params">$el</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> self = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">var</span> childNodes = $el.childNodes;</span><br><span class="line">    [].slice.call(childNodes).forEach(<span class="function"><span class="keyword">function</span> (<span class="params">$childNode</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (self.isElementNode($childNode)) &#123;</span><br><span class="line">            <span class="comment">// 解析节点，但不包括节点内部的文本(内部的文本属于子节点)</span></span><br><span class="line">            <span class="comment">// 这一步其实是解析的属性（写在属性上的指令）</span></span><br><span class="line">            self.compileElementNode($childNode);</span><br><span class="line">            <span class="comment">// 如果有子节点，解析子节点</span></span><br><span class="line">            <span class="keyword">if</span> ($childNode.childNodes &amp;&amp; $childNode.childNodes.length) &#123;</span><br><span class="line">                self.compileElement($childNode);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (self.isTextNode($childNode)) &#123;</span><br><span class="line">            <span class="comment">// 纯文本，解析文本中的模板区域</span></span><br><span class="line">            self.compileTextNode($childNode);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// compileTextNode</span></span><br><span class="line">compileTextNode: <span class="function"><span class="keyword">function</span> (<span class="params">$node</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> text = $node.textContent;</span><br><span class="line">    <span class="keyword">var</span> defaultTagRE = <span class="regexp">/\&#123;\&#123;((?:.|\r?\n)+?)\&#125;\&#125;/g</span></span><br><span class="line">    <span class="keyword">var</span> match = defaultTagRE.exec(text);</span><br><span class="line">    <span class="keyword">if</span> (match) &#123;</span><br><span class="line">        <span class="comment">// do something...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// compileElementNode</span></span><br><span class="line">compileElementNode: <span class="function"><span class="keyword">function</span> (<span class="params">$node</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> nodeAttrs = $node.attributes,</span><br><span class="line">        self = <span class="keyword">this</span>;</span><br><span class="line">    [].slice.call(nodeAttrs).forEach(<span class="function"><span class="keyword">function</span> (<span class="params">nodeAttr</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> attrName = nodeAttr.name;</span><br><span class="line">        <span class="keyword">var</span> dir;</span><br><span class="line">        <span class="comment">// 规定以v-xxx为指令</span></span><br><span class="line">        <span class="keyword">if</span> (dir = self.isDirective(attrName)) &#123;</span><br><span class="line">            <span class="comment">// 如果是指令，则进行指令解析</span></span><br><span class="line">            <span class="keyword">var</span> attrValue = nodeAttr.value;</span><br><span class="line">            <span class="keyword">if</span> (self.isEventDirective(dir)) &#123;</span><br><span class="line">                <span class="comment">// 事件指令，如v-on:click @click</span></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (self.isBindDirective(dir)) &#123;</span><br><span class="line">                <span class="comment">// v-bind:class :class</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 普通指令 v-model等</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="实例化观察者"><a href="#实例化观察者" class="headerlink" title="实例化观察者"></a>实例化观察者</h4><p>在什么时候实例化观察者？</p>
<p>我们再来看看流程图：</p>
<p><img src="/images/20190704/new_vue.png" alt="vue原理流程图"></p>
<p>从流程图中我们不难发现，实例化观察者是在模板解析过程中，也就是说我们在遇到指令、{ { } } 这些内容的时候，我们就要实例化一个 Watcher。</p>
<p>以 <code>compileTextNode</code> 为例，在我们匹配到{ { } } 时，其实我们需要拿 <code>data</code> 中的变量进行填充。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">compileTextNode: <span class="function"><span class="keyword">function</span> (<span class="params">$node</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">if</span> (match) &#123;</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">        CompileUtils.text($node, <span class="keyword">this</span>._vm, match[<span class="number">1</span>])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> CompileUtils = &#123;</span><br><span class="line">    text: <span class="function"><span class="keyword">function</span> (<span class="params">$node, vm, exp</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 获得回调函数，这个函数是处理&#123;&#123;&#125;&#125;、v-text这两种模板指令的</span></span><br><span class="line">        <span class="keyword">var</span> updateFn = updater.textUpdater;</span><br><span class="line">        <span class="comment">// 获得数据 &#123;&#123;name&#125;&#125; 也就是去取mvvm.name的值</span></span><br><span class="line">        <span class="keyword">var</span> value = <span class="keyword">this</span>._getVmValue(vm, exp);</span><br><span class="line">        <span class="comment">// 执行回调更改视图</span></span><br><span class="line">        updateFn($node, value);</span><br><span class="line">        <span class="comment">// 绑定观察者</span></span><br><span class="line">        <span class="keyword">this</span>.bindWatch($node, vm, exp, updateFn);</span><br><span class="line">    &#125;,</span><br><span class="line">    bindWatch: <span class="function"><span class="keyword">function</span> (<span class="params">$node, vm, exp, cb</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Watcher(vm, exp, <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">            cb &amp;&amp; cb($node, value);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> updater = &#123;</span><br><span class="line">    textUpdater: <span class="function"><span class="keyword">function</span> (<span class="params">node, value</span>) </span>&#123;</span><br><span class="line">        node.textContent =</span><br><span class="line">            <span class="keyword">typeof</span> value === <span class="string">'undefined'</span></span><br><span class="line">            ? <span class="string">''</span></span><br><span class="line">            : value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在代码中定义了某一指令的处理方法 <code>updater.textUpdater</code>, 这个方法可以作为一个回调方法传入 Watcher 实例中，待 Watcher 收到更新的通知时，可以执行这个回调方法去更新视图。</p>
<h4 id="Watcher"><a href="#Watcher" class="headerlink" title="Watcher"></a>Watcher</h4><p><img src="/images/20190704/new_vue.png" alt="vue原理流程图"></p>
<p>我们再来观察一遍流程图，来了解 Watcher 做了什么事情：</p>
<ul>
<li>在自身实例化时往属性订阅器(dep)里面添加自己</li>
<li>Dep下发通知时，能调用自身的update()方法，执行由new Watcher时传递进来的回调更新dom。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Watcher</span> (<span class="params">vm, exp, cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>._vm = vm;</span><br><span class="line">    <span class="keyword">this</span>._exp = exp.trim();</span><br><span class="line">    <span class="keyword">this</span>._cb = cb;</span><br><span class="line">    <span class="comment">// 需要往dep中添加自己</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Watcher.prototype = &#123;</span><br><span class="line">    update: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 拿到newValue, 其实就是vm中的数据，代码省略</span></span><br><span class="line">        <span class="keyword">this</span>._cb.call(<span class="keyword">this</span>._vm, newValue);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Dep事件处理中心"><a href="#Dep事件处理中心" class="headerlink" title="Dep事件处理中心"></a>Dep事件处理中心</h4><p>在流程图中还有最后一个成员 Dep 事件处理中心。Dep 需要做的事情有：</p>
<ul>
<li>Watcher实例化时，需要往Dep中添加该实例。（Dep中存储着Watcher的实例）</li>
<li>收到数据变化时需要下发通知，即执行Watcher实例中传入的回调方法。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dep</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.subs = [];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Dep.prototype.addSub = <span class="function"><span class="keyword">function</span> <span class="title">addSub</span> (<span class="params">sub</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.subs.push(sub);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Dep.prototype.notify = <span class="function"><span class="keyword">function</span> <span class="title">notify</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.subs.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">sub</span>) </span>&#123;</span><br><span class="line">        sub.update();</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Dep-会在哪里收到更新的通知"><a href="#Dep-会在哪里收到更新的通知" class="headerlink" title="Dep 会在哪里收到更新的通知"></a>Dep 会在哪里收到更新的通知</h4><p>通过 <code>Object.defineProperty()</code> 方法我们截获到了数据的更改，数据更改时需要更新视图，也就是说我们需要在 <code>Set</code> 方法中动刀子。</p>
<p>从流程图中我们也可以看出是在 <code>observe</code> 中进行实例化 Dep 对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.defineProperty(data, key, &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">set</span>: function (newVal) &#123;</span><br><span class="line">        <span class="keyword">if</span> (newVal === val || (newVal !== newVal &amp;&amp; val !== val)) &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        val = newVal;</span><br><span class="line">        <span class="comment">// 数据发生变化，通知更新</span></span><br><span class="line">        dep.notify();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="Watcher-怎么添加到-Dep-中？"><a href="#Watcher-怎么添加到-Dep-中？" class="headerlink" title="Watcher 怎么添加到 Dep 中？"></a>Watcher 怎么添加到 Dep 中？</h4><p>这里存在一个比较困难的问题：</p>
<p>不同的数据有不同的 <code>Dep</code> 进行管理，每个 <code>Dep</code> 管理着与这个数据有关的 <code>Watcher</code>。<br><code>Watcher</code> 实例化时，我们需要将 <code>Watcher</code> 添加到与之相关的 <code>Dep</code> 中。<br>如何知晓 <code>Dep</code> 和 <code>Watcher</code> 是有关系的？</p>
<p>再者，我们回忆一下如何将 <code>Watcher</code> 添加到 <code>Dep</code> 中？<br>是调用 <code>dep.addSub()</code> 方法。</p>
<p>而我们已经在 <code>Object.defineProperty()</code> 这个闭包内使用 <code>dep</code> 的实例，也就是说我们需要在这个闭包中将 <code>Watcher</code> 和 <code>Dep</code> 建立联系。</p>
<p>这是可能的吗？</p>
<p>答案是可能的。</p>
<h4 id="Get方法是切入口"><a href="#Get方法是切入口" class="headerlink" title="Get方法是切入口"></a>Get方法是切入口</h4><p>Watcher实例化时通过读取一次数据，就能将Watcher实例添加到dep中！</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">observeProperty</span>(<span class="params">data, key, val</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> dep = <span class="keyword">new</span> Dep();</span><br><span class="line">    observe(val);</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(data, key, &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        <span class="keyword">get</span>: function () &#123;</span><br><span class="line">            <span class="comment">// 传入的是什么？</span></span><br><span class="line">            <span class="comment">// 每次读取是否都要添加一次？</span></span><br><span class="line">            dep.addSub(...);</span><br><span class="line">            <span class="keyword">return</span> val;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="keyword">set</span>: function (newVal) &#123;</span><br><span class="line">            <span class="keyword">if</span> (newVal === val || (newVal !== newVal &amp;&amp; val !== val)) &#123;</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            val = newVal;</span><br><span class="line">            dep.notify();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在代码中存在两个注释（问题）：</p>
<ul>
<li>传入的是什么？</li>
<li>每次读取是否都要添加一次？</li>
</ul>
<p>首先第一个问题，我们知道传入的必定是一个 <code>Watcher</code> 实例。<br>第二个问题，我们也能很快的知晓必定不是，读取数据的情况太多了，肯定有一些读取情况是不需要增加观察者实例的。</p>
<p>结合这两个疑问，不难得出：需要把控添加观察者实例的场合。<br>而纵观所有场景，我们也只有在执行 <code>new Watcher()</code> 时需要往 <code>Dep</code> 中添加观察者实例。</p>
<h4 id="把控观察者实例的增加场合"><a href="#把控观察者实例的增加场合" class="headerlink" title="把控观察者实例的增加场合"></a>把控观察者实例的增加场合</h4><p>直接看代码。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// flag</span></span><br><span class="line">Dep.target = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Watcher</span> (<span class="params">vm, exp, cb</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 需要往dep中添加自己</span></span><br><span class="line">    <span class="keyword">this</span>.value = <span class="keyword">this</span>.get();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Watcher.prototype = &#123;</span><br><span class="line">    <span class="keyword">get</span>: function () &#123;</span><br><span class="line">        <span class="comment">// flag 指向 Watcher 实例</span></span><br><span class="line">        Dep.target = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">var</span> value = <span class="keyword">this</span>._vm[<span class="keyword">this</span>._exp];</span><br><span class="line">        <span class="comment">// 读取完毕后 清空flag</span></span><br><span class="line">        Dep.target = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(data, key, &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">get</span>: function () &#123;</span><br><span class="line">        <span class="comment">// 如果flag中存在内容（Watcher实例），就将其加入到Dep中</span></span><br><span class="line">        <span class="keyword">if</span> (Dep.target) &#123;</span><br><span class="line">            dep.addSub(Dep.target);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="一些课后问题"><a href="#一些课后问题" class="headerlink" title="一些课后问题"></a>一些课后问题</h2><h4 id="VUE截获到数据更新后，会通知所有组件进行更新吗？为什么？"><a href="#VUE截获到数据更新后，会通知所有组件进行更新吗？为什么？" class="headerlink" title="VUE截获到数据更新后，会通知所有组件进行更新吗？为什么？"></a>VUE截获到数据更新后，会通知所有组件进行更新吗？为什么？</h4><p><strong>不会</strong>，由Vue的双向绑定原理中可以知道，每一个 Dep 实例化后的对象都会存在一个独立的 subs 数组。在 <code>Object.defineProperty()</code> 截获数据阶段，会为每一个属性生成一个 <code>Dep</code> 实例，当有内容与数据产生联系时，会通过 <code>Dep</code> 实例原型链上的 <code>addSub</code> 方法，将 <code>Watcher</code> 加入到该实例独立的订阅者数组中。当要更新时，只会执行该 Dep 实例独立订阅者数组中保存着的所有 <code>Watcher</code> 订阅者的更新回调。</p>
<h4 id="为什么能够直接通过实例属性，访问到VUE对象上data里面的数据？"><a href="#为什么能够直接通过实例属性，访问到VUE对象上data里面的数据？" class="headerlink" title="为什么能够直接通过实例属性，访问到VUE对象上data里面的数据？"></a>为什么能够直接通过实例属性，访问到VUE对象上data里面的数据？</h4><p>使用了访问属性代理，通过 <code>Object.defineProperty()</code> 方法，在 VUE 对象上创建了一个同名属性，当 <code>get</code> 时，返回的是 <code>data</code> 中的同名属性的值，在 <code>set</code> 时，修改的是 <code>data</code> 中同名属性的值。</p>
<h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><p>本文所有的代码存放在 <a href="https://github.com/yuzhounanhai/yuzhounanhai.github.io/tree/master/project/mvvm" target="_blank" rel="noopener">我的GitHub仓库</a> 中。</p>

        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://yuzhounanhai.github.io/2019/09/29/浅析VUE双向绑定原理/" data-title="浅析VUE双向绑定原理" data-id="ckg20rxea002kbovx04s3ygzn" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vue/">Vue</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/09/29/深入了解AJAX/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          深入了解AJAX
        
      </div>
    </a>
  
  
    <a href="/2019/09/29/浅析Redux实现原理/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">浅析Redux实现原理</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  <div class="github-card" data-github="yuzhounanhai" data-width="100%" data-height="" data-theme="default"></div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/其他/">其他</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端/">前端</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法/">算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络通信/">网络通信</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS/">JS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LeetCode解题/">LeetCode解题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redux/">Redux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TS/">TS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue/">Vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Webpack/">Webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react-dom/">react-dom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react-reconciler/">react-reconciler</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/原理/">原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/笔记/">笔记</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/JS/" style="font-size: 20px;">JS</a> <a href="/tags/LeetCode解题/" style="font-size: 12.5px;">LeetCode解题</a> <a href="/tags/React/" style="font-size: 17.5px;">React</a> <a href="/tags/Redux/" style="font-size: 12.5px;">Redux</a> <a href="/tags/TS/" style="font-size: 10px;">TS</a> <a href="/tags/Vue/" style="font-size: 10px;">Vue</a> <a href="/tags/Webpack/" style="font-size: 10px;">Webpack</a> <a href="/tags/http/" style="font-size: 15px;">http</a> <a href="/tags/react-dom/" style="font-size: 10px;">react-dom</a> <a href="/tags/react-reconciler/" style="font-size: 10px;">react-reconciler</a> <a href="/tags/原理/" style="font-size: 17.5px;">原理</a> <a href="/tags/笔记/" style="font-size: 12.5px;">笔记</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/09/25/自定义React渲染器/">自定义React渲染器</a>
          </li>
        
          <li>
            <a href="/2020/09/25/easy-mock环境搭建/">EasyMock 环境搭建</a>
          </li>
        
          <li>
            <a href="/2019/09/29/简单实现虚拟Dom与Diff算法/">简单实现虚拟DOM与Diff算法</a>
          </li>
        
          <li>
            <a href="/2019/09/29/深入了解AJAX/">深入了解AJAX</a>
          </li>
        
          <li>
            <a href="/2019/09/29/浅析VUE双向绑定原理/">浅析VUE双向绑定原理</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 宇宙南海<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
</nav>
    

<script src="//cdn.jsdelivr.net/github-cards/latest/widget.js"></script>

<script src="/js/jquery-3.4.1.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>